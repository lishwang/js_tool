##### 笔记内容可以参考尚硅谷的 [自定义工具函数库](https://zxfjd3g.github.io/atguigu_utils-docs/)



##### 本仓库一共有两个分支：dev 和 master

- dev分支：封装的js方法在 js 代码中简单使用
- master分支：通过webpack打包后，生成UMD形式的库，可以同时在nodejs和浏览器环境中使用，可以通过es6、commonjs、es5的方式引入使用；并且在该分支下，还对代码做了调整，使其可以发布到npm中央仓库上供所有人使用；

##### 通过webpack打包后，生成UMD形式的库

```
# webpack.config.js 文件内
// 出口
output: {
    // 向外暴露的对象的名称，打包后，引入 wls_utils.js 文件后，可以在全局直接使用 utils ，里面包含本次打包的入口文件内的导出的所有方法
    library: 'utils',
    // 打包生成umd的库，模块导入的时候可以通过esm（es6）/commonjs（common）/requirejs（amd）的语法引入该打包后的文件
    libraryTarget: 'umd',
  }
```

##### 发布到npm中央仓库

```
# package.json 文件内
name: 必须是唯一的名称(在npm在线中央仓库中没有同名的，小写)
main: 必须指定为打包生成的js文件路径
keywords: 指定一些方便别的程序员搜索到当前库的关键字（npm中可以直接搜到）
```

###### 发布之前需要对npm本地做如下配置修改

- npm配置的中央仓库不能是淘宝镜像，因为淘宝镜像是一个只读镜像，只能下载不能上传；
- 发布前必须执行: npm config set registry https://registry.npmjs.org/
- 不用发布时再改回: npm config set registry http://registry.npm.taobao.org/
- 查看配置: npm config list

###### 注册npm中央仓库账号

- 注册地址: https://www.npmjs.com/
- 关键信息: 用户名/密码/邮箱(需要验证)

###### 添加用户

- 执行: npm addUser 或者 npm login
- 登陆npm仓库
- 依次指定用户名/密码/邮箱（密码输入的时候是不可见的）

###### 发布仓库

- 执行: npm publish
- 常见的发布失败的错误

![](.\image\常见的发布失败的错误.png)

- 发布失败, 原因是库的名称重复了, 修改name为一个唯一值, 再发布

###### 如果以后需要更新npm中央仓代码，需要更新代码后再发布

- 修改项目库的版本号: package.json 中的version 从1.0.0 改为1.0.1, 注意一定要变大
- 修改代码后重新打包: npm run build
- 执行发布: npm publish

###### 强制删除已发布在npm中央仓的库

- 执行: npm unpublish --force  默认删除最近一次提交的版本
- 执行: npm unpublish 名字 --force  删除这个npm包
- 注意: 必须在72小时内, 否则不能再删除

##### 我的npm账号为 wls_   密码为 平常的密码，字母后面加名字缩写